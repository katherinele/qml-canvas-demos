ports from http://29a.ch/2010/3/24/normal-mapping-with-javascript-and-canvas-tag